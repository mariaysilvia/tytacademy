<!DOCTYPE html>
<html lang="es">
    <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TYT ACADEMY</title>
    <link rel="stylesheet" href="../simulacropruebas/estilospruebas.css/pruebasdiseñocritica.css" />
    <link rel="icon"href="../formulariosiniciomodulos/imagenesVideos/lecturacriticamodulo.png"type="image/x-icon"/>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100..900&display=swap"rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="crossorigin="anonymous"referrerpolicy="no-referrer"/>
    <link rel="stylesheet"href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"crossorigin="anonymous"/>
    </head>
    <body>
    <header>
    <h1>TYT ACADEMY</h1>
    <h2>SIMULACRO DE LECTURA CRÍTICA</h2>
    <p>Lectura crítica <strong>Total de preguntas: <span id="totalPreguntas">0</span></strong></p>
    </header>
    <div class="container">
        <form id="formPreguntas" action="../APRENDIZ/controlador/corregirpruebacritica.php" method="POST">
            <div id="preguntas"></div>
            <button type="submit" class="btn-enviar">Enviar Respuestas</button>
        </form>
    </div>

    <script>
    // Obtener los parámetros de la URL
    const urlParams = new URLSearchParams(window.location.search);
    const areas = urlParams.get('areas');
    const preguntas = urlParams.get('preguntas');

    console.log('Parámetros recibidos:', { areas, preguntas });

    // Mostrar mensaje de carga
    const contenedorPreguntas = document.getElementById('preguntas');
    contenedorPreguntas.innerHTML = '<div class="cargando">Cargando preguntas...</div>';

    // Obtener las preguntas del servidor
    const url = '/trabajos/PruebasTYT/APRENDIZ/controlador/seleccionarPreguntas.php';
    console.log('URL del controlador:', url);

    fetch(url, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            tipoPrueba: 'critica',
            areas: areas,
            preguntas: preguntas
        })
    })
    .then(response => {
        console.log('Respuesta del servidor:', response);
        if (!response.ok) {
            throw new Error('Error en la petición: ' + response.status);
        }
        return response.json();
    })
    .then(data => {
        console.log('Datos recibidos:', data);
        if (data.success) {
            mostrarPreguntas(data.data);
            document.getElementById('totalPreguntas').textContent = data.data.length;
        } else {
            alert(data.message || 'No se pudieron cargar las preguntas');
        }
    })
    .catch(error => {
        console.error('Error completo:', error);
        alert('Error al cargar las preguntas: ' + error.message);
    });

    function mostrarPreguntas(preguntas) {
        const contenedor = document.getElementById('preguntas');
        contenedor.innerHTML = '';
        
        preguntas.forEach((pregunta, index) => {
            const section = document.createElement('section');
            section.id = `pregunta${index + 1}`;
            section.className = 'question';
            
            let html = `<h3><strong>${index + 1}.</strong> ${pregunta.pregunta}</h3>`;
            
            if (pregunta.imagen) {
                html += `<img src="/trabajos/PruebasTYT/APRENDIZ/publico/imagenesPREGUNTAS/${pregunta.imagen}" alt="Imagen pregunta">`;
            }
            
            pregunta.respuestas.forEach((respuesta, i) => {
                const letra = String.fromCharCode(65 + i); // A, B, C, D
                html += `
                    <label>
                        <input type="radio" value="${respuesta.id}" name="p${index + 1}" required />
                        <strong>${letra}.</strong> ${respuesta.texto}
                    </label>
                `;
            });
            
            section.innerHTML = html;
            contenedor.appendChild(section);
        });
    }
    </script>

    <h2><span id="resultados"></span>
    <div class="emoji"><img src="/trabajos/PruebasTYT/APRENDIZ/publico/imagenes/fiesta.gif" alt=""></div></h2>
    <h2><span id="incorrectas"></span></h2>
    
  <button type="button" id="btnCorregir">Corregir</button>
  <div class="regresar">
    <br>
    <a href="/trabajos/PruebasTYT/APRENDIZ/vista/PRUEBAS.php">¿Desea cambiar de prueba?</a>
  </div>

  <!--boton de ir hacia arriba-->
  <div id="button-up">
    <i class="fa-solid fa-chevron-up"></i>
  </div>

    </div>
    <script src="/trabajos/PruebasTYT/APRENDIZ/publico/js/corregirpruebacritica.js"></script>
    <script src="/trabajos/PruebasTYT/APRENDIZ/publico/js/botonarriba.js"></script>
  </body>
</html>
